<!DOCTYPE html>
<html lang="ja">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
	</head>
	<body>
		<style>
			@import "https://unpkg.com/open-props/open-props.min.css";
			@import "https://unpkg.com/open-props/normalize.min.css";
			@import "https://rodydavis.github.io/material-design-lite/css/mdl.css";

			@import "https://unpkg.com/open-props/open-props.min.css";
			@import "https://unpkg.com/open-props/normalize.min.css";
			@import "https://rodydavis.github.io/material-design-lite/css/mdl.css";

			*,
			*:after,
			*:before {
				box-sizing: border-box;
			}

			body {
				display: flex;
				align-items: center;
				justify-content: center;
				flex-wrap: wrap;
				gap: var(--size-4);
				place-items: center;
				min-height: 100vh;
				background: var(--surface-2);
				font-family: "Google Sans", sans-serif, system-ui;
			}

			ul {
				border-radius: var(--md-sys-shape-medium);
				width: 50vmin;
				min-width: 300px;
				aspect-ratio: 4 / 6;
				background: var(--gray-0);
				display: grid;
				padding: 0;
				margin: 0;
				padding: var(--size-4);
				gap: var(--size-4);
				grid-template-columns: repeat(4, 1fr);
				overflow: auto;
				list-style-type: none;
				transition: all 0.5s var(--ease-elastic-2);
			}

			.card.elevated {
				padding: 0;
				margin: 0;
				background-color: var(--blue-2);
				min-width: 0;
				transition: all 0.5s var(--ease-elastic-2);
			}

			.card .actions {
				display: grid;
				flex-direction: column;
				grid-template-columns: auto auto;
				gap: var(--size-2) var(--size-4);
			}

			.controls.card.elevated {
				background-color: var(--md-sys-color-surface);
			}

			.grid .card {
				aspect-ratio: 1;
				transform: scale(calc(0.25 + (var(--shown, 1) * 0.75)));
			}

			.zipper .card {
				--distance: 250%;
				aspect-ratio: 1;
				transform: translateX(
						calc((var(--distance) * -1) + (var(--shown, 1) * var(--distance)))
					)
					scale(calc(0.25 + (var(--shown, 1) * 0.75)));
			}

			.zipper li:is(:nth-of-type(4n), :nth-of-type(4n + 3):nth-child(n)) .card {
				--distance: -250%;
				transition: all 0.5s var(--ease-elastic-1);
			}

			.rotater .card {
				aspect-ratio: 1;
				transform: rotate(
						calc(
							(
									(var(--rotation, 0) * -1) +
										(var(--shown, 1) * var(--rotation, 0))
								) * 1deg
						)
					)
					scale(calc(0.25 + (var(--shown, 1) * 0.75)));
			}

			.rotater li:nth-of-type(n) .card {
				--rotation: -270;
				/*background: red;*/
			}

			.rotater li:nth-of-type(2n) .card {
				--rotation: -180;
				/*background: green;*/
			}
			.rotater li:nth-of-type(4n + 3):nth-child(n) .card {
				--rotation: 180;
				/*background: orange;*/
			}
			.rotater li:nth-of-type(n):nth-child(4n) .card {
				--rotation: 270;
				/*background: purple;*/
			}

			li {
				padding: 0;
			}

			.list li {
				min-height: 40px;
				height: 8vmin;
				grid-column: 1 / -1;
			}

			.list .card {
				height: 100%;
				transform: scaleX(calc(0.25 + (var(--shown, 1) * 0.75)));
			}

			.horizontal {
				width: 75vmin;
				aspect-ratio: 4 / 2;
				display: flex;
			}

			.horizontal li {
				min-width: 25%;
				grid-template-columns: repeat(auto-fit, 1fr);
			}

			.horizontal .card {
				height: 100%;
				transform: scaleY(calc(0.25 + (var(--shown, 1) * 0.75)));
			}
		</style>

		<ul class="grid"></ul>
		<div class="controls card elevated filled">
			<div class="actions">
				<label for="grid">Grid</label>
				<input checked type="radio" name="style" value="grid" id="grid" />
				<label for="list">List</label>
				<input type="radio" name="style" value="list" id="list" />
				<label for="horizontal">Horizontal</label>
				<input type="radio" name="style" value="horizontal" id="horizontal" />
				<label for="zipper">Zipper</label>
				<input type="radio" name="style" value="zipper" id="zipper" />
				<label for="rotater">Rotater</label>
				<input type="radio" name="style" value="rotater" id="rotater" />
			</div>
		</div>

		<script>
			const LIST = document.querySelector("ul");
			const CONTROLS = document.querySelector(".controls");
			const COUNT = 256;

			CONTROLS.addEventListener("change", (e) => {
				LIST.className = e.target.value;
			});

			const createTile = () => {
				const ITEM = document.createElement("li");
				const CARD = document.createElement("div");
				CARD.className = "card elevated";
				ITEM.appendChild(CARD);
				LIST.appendChild(ITEM);
			};

			for (let t = 0; t < COUNT; t++) {
				if (window.CP.shouldStopExecution(0)) break;
				createTile();
			}
			window.CP.exitedLoop(0);

			const TILES = document.querySelectorAll("li");

			let OPTIONS = {
				root: LIST,
				rootMargin: "0px",
				threshold: 0,
			};

			const handleIntersection = (entries, observer) => {
				for (const entry of entries) {
					entry.target.style.setProperty(
						"--shown",
						entry.isIntersecting ? 1 : 0
					);
				}
			};

			const observer = new IntersectionObserver(handleIntersection, OPTIONS);

			TILES.forEach((TILE) => observer.observe(TILE));
		</script>
	</body>
</html>
